/* Find different or missing rows*/
SELECT partner_id,IFNULL(usage_percent,''),IFNULL(usage_limit_warning,''),IFNULL(url2,''),IFNULL(url1,''),IFNULL(updated_at,''),IFNULL(storage_usage,''),IFNULL(service_config_id,''),IFNULL(secret,''),IFNULL(prefix,''),IFNULL(phone,''),IFNULL(partner_package,''),IFNULL(partner_alias,''),IFNULL(notify,''),IFNULL(max_number_of_hits_per_day,''),IFNULL(moderate_content,''),IFNULL(ks_max_expiry_in_seconds,''),IFNULL(invalid_login_count,''),IFNULL(eighty_percent_warning,''),IFNULL(describe_yourself,''),IFNULL(debug_level,''),IFNULL(custom_data,''),IFNULL(create_user_on_demand,''),IFNULL(created_at,''),IFNULL(content_categories,''),IFNULL(commercial_use,''),IFNULL(appear_in_search,''),IFNULL(adult_content,''),IFNULL(admin_secret,''),IFNULL(admin_email,''),IFNULL(Partner_type_ID,''),IFNULL(ANONYMOUS_KUSER_ID,''),IFNULL(Partner_Status_ID,'') 
FROM kalturadw.dwh_dim_partners
 WHERE (partner_id,IFNULL(usage_percent,''),IFNULL(usage_limit_warning,''),IFNULL(url2,''),IFNULL(url1,''),IFNULL(updated_at,''),IFNULL(storage_usage,''),IFNULL(service_config_id,''),IFNULL(secret,''),IFNULL(prefix,''),IFNULL(phone,''),IFNULL(partner_package,''),IFNULL(partner_alias,''),IFNULL(notify,''),IFNULL(max_number_of_hits_per_day,''),IFNULL(moderate_content,''),IFNULL(ks_max_expiry_in_seconds,''),IFNULL(invalid_login_count,''),IFNULL(eighty_percent_warning,''),IFNULL(describe_yourself,''),IFNULL(debug_level,''),IFNULL(custom_data,''),IFNULL(create_user_on_demand,''),IFNULL(created_at,''),IFNULL(content_categories,''),IFNULL(commercial_use,''),IFNULL(appear_in_search,''),IFNULL(adult_content,''),IFNULL(admin_secret,''),IFNULL(admin_email,''),IFNULL(Partner_type_ID,''),IFNULL(ANONYMOUS_KUSER_ID,''),IFNULL(Partner_Status_ID,'')) 
NOT IN (SELECT id,IFNULL(usage_percent,''),IFNULL(usage_limit_warning,''),IFNULL(url2,''),IFNULL(url1,''),IF(updated_at IS NULL OR CAST(updated_at AS CHAR)='','2099-01-01 00:00:00',updated_at),IFNULL(storage_usage,''),IFNULL(service_config_id,''),IFNULL(secret,''),IFNULL(prefix,''),IFNULL(phone,''),IF(partner_package IS NULL OR CAST(partner_package AS CHAR)='','-1',partner_package),IFNULL(partner_alias,''),IF(notify IS NULL OR CAST(notify AS CHAR)='','-1',notify),IFNULL(max_number_of_hits_per_day,''),IF(moderate_content IS NULL OR CAST(moderate_content AS CHAR)='','-1',moderate_content),IFNULL(ks_max_expiry_in_seconds,''),IFNULL(invalid_login_count,''),IFNULL(eighty_percent_warning,''),IFNULL(describe_yourself,''),IFNULL(debug_level,''),IFNULL(custom_data,''),IFNULL(create_user_on_demand,''),IF(created_at IS NULL OR CAST(created_at AS CHAR)='','2099-01-01 00:00:00',created_at),IF(content_categories IS NULL OR CAST(content_categories AS CHAR)='','Missing Value',content_categories),IF(commercial_use IS NULL OR CAST(commercial_use AS CHAR)='','-1',commercial_use),IFNULL(appear_in_search,''),IF(adult_content IS NULL OR CAST(adult_content AS CHAR)='','-1',adult_content),IFNULL(admin_secret,''),IF(admin_email IS NULL OR CAST(admin_email AS CHAR)='','Missing Value',admin_email),IF(TYPE IS NULL OR CAST(TYPE AS CHAR)='','-1',TYPE),IF(ANONYMOUS_KUSER_ID IS NULL OR CAST(ANONYMOUS_KUSER_ID AS CHAR)='','-1',ANONYMOUS_KUSER_ID),IF(STATUS IS NULL OR CAST(STATUS AS CHAR)='','-1',STATUS)
		FROM kaltura.partner)
UNION ALL 
 SELECT id,IFNULL(usage_percent,''),IFNULL(usage_limit_warning,''),IFNULL(url2,''),IFNULL(url1,''),IF(updated_at IS NULL OR CAST(updated_at AS CHAR)='','2099-01-01 00:00:00',updated_at),IFNULL(storage_usage,''),IFNULL(service_config_id,''),IFNULL(secret,''),IFNULL(prefix,''),IFNULL(phone,''),IF(partner_package IS NULL OR CAST(partner_package AS CHAR)='','-1',partner_package),IFNULL(partner_alias,''),IF(notify IS NULL OR CAST(notify AS CHAR)='','-1',notify),IFNULL(max_number_of_hits_per_day,''),IF(moderate_content IS NULL OR CAST(moderate_content AS CHAR)='','-1',moderate_content),IFNULL(ks_max_expiry_in_seconds,''),IFNULL(invalid_login_count,''),IFNULL(eighty_percent_warning,''),IFNULL(describe_yourself,''),IFNULL(debug_level,''),IFNULL(custom_data,''),IFNULL(create_user_on_demand,''),IF(created_at IS NULL OR CAST(created_at AS CHAR)='','2099-01-01 00:00:00',created_at),IF(content_categories IS NULL OR CAST(content_categories AS CHAR)='','Missing Value',content_categories),IF(commercial_use IS NULL OR CAST(commercial_use AS CHAR)='','-1',commercial_use),IFNULL(appear_in_search,''),IF(adult_content IS NULL OR CAST(adult_content AS CHAR)='','-1',adult_content),IFNULL(admin_secret,''),IF(admin_email IS NULL OR CAST(admin_email AS CHAR)='','Missing Value',admin_email),IF(TYPE IS NULL OR CAST(TYPE AS CHAR)='','-1',TYPE),IF(ANONYMOUS_KUSER_ID IS NULL OR CAST(ANONYMOUS_KUSER_ID AS CHAR)='','-1',ANONYMOUS_KUSER_ID),IF(STATUS IS NULL OR CAST(STATUS AS CHAR)='','-1',STATUS) 
FROM kaltura.partner
 WHERE (id,IFNULL(usage_percent,''),IFNULL(usage_limit_warning,''),IFNULL(url2,''),IFNULL(url1,''),IF(updated_at IS NULL OR CAST(updated_at AS CHAR)='','2099-01-01 00:00:00',updated_at),IFNULL(storage_usage,''),IFNULL(service_config_id,''),IFNULL(secret,''),IFNULL(prefix,''),IFNULL(phone,''),IF(partner_package IS NULL OR CAST(partner_package AS CHAR)='','-1',partner_package),IFNULL(partner_alias,''),IF(notify IS NULL OR CAST(notify AS CHAR)='','-1',notify),IFNULL(max_number_of_hits_per_day,''),IF(moderate_content IS NULL OR CAST(moderate_content AS CHAR)='','-1',moderate_content),IFNULL(ks_max_expiry_in_seconds,''),IFNULL(invalid_login_count,''),IFNULL(eighty_percent_warning,''),IFNULL(describe_yourself,''),IFNULL(debug_level,''),IFNULL(custom_data,''),IFNULL(create_user_on_demand,''),IF(created_at IS NULL OR CAST(created_at AS CHAR)='','2099-01-01 00:00:00',created_at),IF(content_categories IS NULL OR CAST(content_categories AS CHAR)='','Missing Value',content_categories),IF(commercial_use IS NULL OR CAST(commercial_use AS CHAR)='','-1',commercial_use),IFNULL(appear_in_search,''),IF(adult_content IS NULL OR CAST(adult_content AS CHAR)='','-1',adult_content),IFNULL(admin_secret,''),IF(admin_email IS NULL OR CAST(admin_email AS CHAR)='','Missing Value',admin_email),IF(TYPE IS NULL OR CAST(TYPE AS CHAR)='','-1',TYPE),IF(ANONYMOUS_KUSER_ID IS NULL OR CAST(ANONYMOUS_KUSER_ID AS CHAR)='','-1',ANONYMOUS_KUSER_ID),IF(STATUS IS NULL OR CAST(STATUS AS CHAR)='','-1',STATUS))
 NOT IN (SELECT partner_id,IFNULL(usage_percent,''),IFNULL(usage_limit_warning,''),IFNULL(url2,''),IFNULL(url1,''),IFNULL(updated_at,''),IFNULL(storage_usage,''),IFNULL(service_config_id,''),IFNULL(secret,''),IFNULL(prefix,''),IFNULL(phone,''),IFNULL(partner_package,''),IFNULL(partner_alias,''),IFNULL(notify,''),IFNULL(max_number_of_hits_per_day,''),IFNULL(moderate_content,''),IFNULL(ks_max_expiry_in_seconds,''),IFNULL(invalid_login_count,''),IFNULL(eighty_percent_warning,''),IFNULL(describe_yourself,''),IFNULL(debug_level,''),IFNULL(custom_data,''),IFNULL(create_user_on_demand,''),IFNULL(created_at,''),IFNULL(content_categories,''),IFNULL(commercial_use,''),IFNULL(appear_in_search,''),IFNULL(adult_content,''),IFNULL(admin_secret,''),IFNULL(admin_email,''),IFNULL(Partner_type_ID,''),IFNULL(ANONYMOUS_KUSER_ID,''),IFNULL(Partner_Status_ID,'')
		FROM kalturadw.dwh_dim_partners)
ORDER BY partner_id;
